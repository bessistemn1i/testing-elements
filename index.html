<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Test-modules</title>
    <script src='https://www.google.com/recaptcha/api.js?render=6Lf31osUAAAAAM0KIuqHnTRm8Kj9iC-75RpbYvYR'></script>
</head>

<body>
    <form method="post" action="verify_captcha.php">
        <p>
            <b>Введите комментарий:</b>
        </p>

        <p>
            <textarea name="comment" rows="12" cols="21"></textarea>
        </p>
         
        <p>
            <input type="submit" value="Отправить">
        </p>
    </form>
</body>
<script>
    grecaptcha.ready(function() {
        grecaptcha.execute('6Lf31osUAAAAAM0KIuqHnTRm8Kj9iC-75RpbYvYR', {action: 'add_comment'})
            .then(function(token) {
                var data = new FormData();
                data.append("action", 'add_comment');
                data.append("token", token);
 
                fetch('/verify_captcha.php', {
                    method: 'POST',
                    body: data
                }).then(function(response) {
                    response.json().then(function(data) {
                        if (!data) document.getElementById('comment-form').style.display = 'none';
                    });
                });
            });
    });
    </script>
<script src="main.js"></script>

</html>
